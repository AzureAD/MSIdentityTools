---
sidebar_class_name: hidden
description: Grants delegated permissions to MCP clients for the Microsoft MCP Server for Enterprise.
id: Grant-MsIdMcpServerPermission
title: Grant-MsIdMcpServerPermission
hide_title: false
hide_table_of_contents: false
custom_edit_url: https://github.com/azuread/msidentitytools/blob/main/src/Grant-MsIdMcpServerPermission.ps1
---

## SYNOPSIS

Grants delegated permissions to MCP clients for the Microsoft MCP Server for Enterprise.

## SYNTAX

### PredefinedClients (Default)

```powershell
Grant-MsIdMcpServerPermission [-MCPClient <String[]>] [-Scopes <String[]>] [-ProgressAction <ActionPreference>]
 [<CommonParameters>]
```

### PredefinedClientsScopes

```powershell
Grant-MsIdMcpServerPermission -MCPClient <String[]> -Scopes <String[]> [-ProgressAction <ActionPreference>]
 [<CommonParameters>]
```

### CustomClientsScopes

```powershell
Grant-MsIdMcpServerPermission -MCPClientServicePrincipalId <String[]> -Scopes <String[]>
 [-ProgressAction <ActionPreference>] [<CommonParameters>]
```

### CustomClients

```powershell
Grant-MsIdMcpServerPermission -MCPClientServicePrincipalId <String[]> [-ProgressAction <ActionPreference>]
 [<CommonParameters>]
```

## DESCRIPTION

This cmdlet grants OAuth2 delegated permissions to MCP clients (like VS Code or Visual Studio)
to access the Microsoft MCP Server for Enterprise.
You can specify predefined clients or
provide custom MCP client app IDs.

## EXAMPLES

### EXAMPLE 1

```powershell
Connect-MgGraph -Scopes DelegatedPermissionGrant.ReadWrite.All, Application.ReadWrite.All
Grant-MsIdMcpServerPermission
Grants all available permissions to Visual Studio Code (default MCP client if none specified).
```

### EXAMPLE 2

```powershell
Connect-MgGraph -Scopes DelegatedPermissionGrant.ReadWrite.All, Application.ReadWrite.All
Grant-MsIdMcpServerPermission -MCPClient 'VisualStudioCode'
Grants all available permissions to Visual Studio Code.
```

### EXAMPLE 3

```powershell
Connect-MgGraph -Scopes DelegatedPermissionGrant.ReadWrite.All, Application.ReadWrite.All
Grant-MsIdMcpServerPermission -MCPClient 'VisualStudio', 'VisualStudioCode'
Grants all available permissions to Visual Studio and Visual Studio Code.
```

### EXAMPLE 4

```powershell
Connect-MgGraph -Scopes DelegatedPermissionGrant.ReadWrite.All, Application.ReadWrite.All
Grant-MsIdMcpServerPermission -MCPClientServicePrincipalId '12345678-1234-1234-1234-123456789012'
Grants all available permissions to a custom MCP client using its service principal ID.
```

### EXAMPLE 5

```powershell
Connect-MgGraph -Scopes DelegatedPermissionGrant.ReadWrite.All, Application.ReadWrite.All
Grant-MsIdMcpServerPermission -MCPClient 'VisualStudioCode' -Scopes 'MCP.User.Read.All', 'MCP.Group.Read.All'
Grant specific permissions to Visual Studio Code.
```

### EXAMPLE 6

```powershell
Connect-MgGraph -Scopes DelegatedPermissionGrant.ReadWrite.All, Application.ReadWrite.All
Grant-MsIdMcpServerPermission -MCPClient 'VisualStudioMSAL' -Scopes 'MCP.User.Read.All'
Grants specific permissions to Visual Studio MSAL client.
```

### EXAMPLE 7

```powershell
Connect-MgGraph -Scopes DelegatedPermissionGrant.ReadWrite.All, Application.ReadWrite.All
Grant-MsIdMcpServerPermission -MCPClientServicePrincipalId '12345678-1234-1234-1234-123456789012' -Scopes 'MCP.User.Read.All'
Grants specific permissions to a custom MCP client.
```

## PARAMETERS

### -MCPClient

Specifies the Visual Studio client(s) to grant permissions to.
Can be one or more of:
'VisualStudioCode', 'VisualStudio', 'VisualStudioMSAL'.
Either this parameter or MCPClientServicePrincipalId must be specified.

```yaml
Type: String[]
Parameter Sets: PredefinedClients
Aliases:

Required: False
Position: Named
Default value: @('VisualStudioCode')
Accept pipeline input: False
Accept wildcard characters: False
```

```yaml
Type: String[]
Parameter Sets: PredefinedClientsScopes
Aliases:

Required: True
Position: Named
Default value: @('VisualStudioCode')
Accept pipeline input: False
Accept wildcard characters: False
```

### -MCPClientServicePrincipalId

The service principal ID(s) of custom MCP client(s) to grant permissions to.
Must be valid GUID format(s).
Either this parameter or MCPClient must be specified.

```yaml
Type: String[]
Parameter Sets: CustomClientsScopes, CustomClients
Aliases:

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -Scopes

Specific scopes to grant.
If not specified, all available scopes are granted.

```yaml
Type: String[]
Parameter Sets: PredefinedClients
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

```yaml
Type: String[]
Parameter Sets: PredefinedClientsScopes, CustomClientsScopes
Aliases:

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -ProgressAction

\{\{ Fill ProgressAction Description \}\}

```yaml
Type: ActionPreference
Parameter Sets: (All)
Aliases: proga

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### CommonParameters

This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see [about_CommonParameters](http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

## OUTPUTS

## NOTES

## RELATED LINKS
