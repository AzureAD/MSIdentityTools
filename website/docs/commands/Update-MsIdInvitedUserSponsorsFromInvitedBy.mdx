---
sidebar_class_name: hidden
description: Update the Sponsors attribute to include the user who initially invited them to the tenant using the InvitedBy property.
id: Update-MsIdInvitedUserSponsorsFromInvitedBy
title: Update-MsIdInvitedUserSponsorsFromInvitedBy
hide_title: false
hide_table_of_contents: false
custom_edit_url: https://github.com/azuread/msidentitytools/blob/main/src/Update-MsIdInvitedUserSponsorsFromInvitedBy.ps1
---

## SYNOPSIS

Update the Sponsors attribute to include the user who initially invited them to the tenant using the InvitedBy property.
This script can be used to backfill Sponsors attribute for existing users.

## SYNTAX

### AllInvitedGuests (Default)

```powershell
Update-MsIdInvitedUserSponsorsFromInvitedBy [-All] [-ProgressAction <ActionPreference>] [-WhatIf] [-Confirm]
 [<CommonParameters>]
```

### ByUsers

```powershell
Update-MsIdInvitedUserSponsorsFromInvitedBy [-UserId <String[]>] [-ProgressAction <ActionPreference>] [-WhatIf]
 [-Confirm] [<CommonParameters>]
```

## DESCRIPTION

Update the Sponsors attribute to include the user who initially invited them to the tenant

## EXAMPLES

### EXAMPLE 1

```powershell
Update-MsIdInvitedUserSponsorsFromInvitedBy
```

Enumerate all invited users in the Tenant and update Sponsors using InvitedBy value

### EXAMPLE 2

```powershell
Update-MsIdInvitedUserSponsorsFromInvitedBy -All
```

Enumerate all invited users in the Tenant and update Sponsors using InvitedBy value

### EXAMPLE 3

```powershell
Update-MsIdInvitedUserSponsorsFromInvitedBy -UserId user1@contoso.com,user2@contoso.com
```

For only specified users in the tenant update Sponsors using InvitedBy value

## PARAMETERS

### -UserId

UserId of Guest User

```yaml
Type: String[]
Parameter Sets: ByUsers
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -All

Enumerate and Update All Guest Users.

```yaml
Type: SwitchParameter
Parameter Sets: AllInvitedGuests
Aliases:

Required: False
Position: Named
Default value: False
Accept pipeline input: False
Accept wildcard characters: False
```

### -WhatIf

Shows what would happen if the cmdlet runs.
The cmdlet is not run.

```yaml
Type: SwitchParameter
Parameter Sets: (All)
Aliases: wi

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -Confirm

Prompts you for confirmation before running the cmdlet.

```yaml
Type: SwitchParameter
Parameter Sets: (All)
Aliases: cf

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -ProgressAction

\{\{ Fill ProgressAction Description \}\}

```yaml
Type: ActionPreference
Parameter Sets: (All)
Aliases: proga

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### CommonParameters

This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see [about_CommonParameters](http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

## OUTPUTS

## NOTES

## RELATED LINKS

[Feature Page: https://learn.microsoft.com/en-us/azure/active-directory/external-identities/b2b-sponsors
EM: https://learn.microsoft.com/en-us/azure/active-directory/governance/entitlement-management-access-package-create\

API Docs:
Sponsors api - https://learn.microsoft.com/en-us/graph/api/user-post-sponsors?view=graph-rest-beta
Invite api - https://learn.microsoft.com/en-us/graph/api/resources/invitation?view=graph-rest-beta
ELM - https://learn.microsoft.com/en-us/graph/api/resources/entitlementmanagement-overview?view=graph-rest-beta
Invited BY - https://learn.microsoft.com/en-us/graph/api/user-list-invitedby?view=graph-rest-beta]()
